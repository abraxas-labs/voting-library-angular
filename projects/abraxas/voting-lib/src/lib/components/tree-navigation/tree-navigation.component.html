<div class="node-navigation">
  @for (node of nodes; track node) {
    <div>
      <div [class.selected]="node === selectedNode" class="node-row" [ngStyle]="{ 'padding-left': padding }">
        <bc-icon
          [class.hidden]="!node.filteredChildNodes || node.filteredChildNodes?.length === 0"
          (click)="toggleOpen(node)"
          [icon]="caretIcon(node)"
        ></bc-icon>
        <label (click)="toggleSelectedNode(node)" (dblclick)="toggleOpen(node)">
          @if (rowTemplate) {
            <ng-container *ngTemplateOutlet="rowTemplate; context: { $implicit: node }"></ng-container>
          }
          <ng-template #noRowTemplate>
            {{ node.displayName }}
          </ng-template>
        </label>
        @if (node === selectedNode && editModeEnabled) {
          <div class="action-icons">
            @if (node.showInfoButton) {
              <bc-icon icon="info-circle-o" (click)="nodeInfo.emit(node)"></bc-icon>
            }
            @if (node.showEditButton) {
              <bc-icon icon="edit" (click)="nodeEdit.emit(node)"></bc-icon>
            }
            @if (node.showDeleteButton) {
              <bc-icon icon="trash" iconColor="error" (click)="nodeDelete.emit(node)"></bc-icon>
            }
          </div>
        }
      </div>
      <div>
        @if (node.filteredChildNodes && node.open) {
          <vo-lib-tree-navigation
            [nodes]="node.filteredChildNodes"
            [(selectedNode)]="selectedNode"
            (nodeInfo)="nodeInfo.emit($event)"
            (nodeEdit)="nodeEdit.emit($event)"
            (nodeDelete)="nodeDelete.emit($event)"
            [depth]="depth + 1"
            [rowTemplate]="rowTemplate"
            [editModeEnabled]="editModeEnabled"
          ></vo-lib-tree-navigation>
        }
      </div>
    </div>
  }
</div>
